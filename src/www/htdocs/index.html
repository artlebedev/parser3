@main[]
<form method=post>
<input type=hidden name=a value=123>
<table border=1 width=250><tr><td>$form:name</td></tr></table>
<textarea name=name rows=5 cols=40>^untaint[html]{^default[$form:name;Пробный текст: А.Ф._Петросян <<Жизнь в Аду>>
нажми Submit]}</textarea><BR>
<input type=submit>
</form>
<hr>

#^main[]
#^use[$form:file]

$строка[вася ЗдЕсЬ]
^^строка.upper[]=^строка.upper[]<br>
^^строка.lower[]=^строка.lower[]<br>
<hr>


$a[12]
^a.int[]
<hr>


$t[^table:set{key	value
1	v1
2	v2}]
$h[^t.hash[key]]

^sql_test[$SQL.connect-string]
#^sql_test[mysql://test:test@localhost/test/cp1251_koi8]

<HR>
$abc{}
$tn[^table:set[nameless]{a1	b1
a2	b2
}]
$x[^tn.locate[0;a2]]
^$tn.1=$tn.1
<hr>
$t0[^table:set{key	a	b
1	a1
2	a2	b2
}]
^if(^t0.locate[key;2] && "a" ne "b"){y;n}
<hr>
$currentFolder[/a/b]
$path[^currentFolder.lsplit[/]]
^path.flip[]
$path{
^menu{$0}{,}
}
<hr>
$t1[^table:set{key	value
1	v1
2	v2}]
$h1[^t1.hash[key]]
^h1.default[$value[nothing]]
^$h1.2.value=$h1.2.value<br>
^$h1.2x.value=$h1.2x.value<br>
<hr>
$t2[^table:set{key	a	b
1	a1
2	a2	b2
}]
t2 ^if(^t2.empty[]){empty}{not empty}<br>
^t2.offset(1)
$t2.b
$r[^t2.record[]]
<hr>
$th[^t2.hash[b]]
^$th.b2.a=$th.b2.a<br>
<hr>
$th[^t2.hash[key;a]]
^$th.2.a=$th.2.a<br>
<hr>
#^OP:eval(1<2)

$filelist[^table:dir[.]]
<hr>
$path[/news/tululu/]
#^path.flip[]
<hr>
$branches[^table:set{name	val
index.cgihtml	123
}]
$splitURI[^request:uri.lsplit[/]]
name ^if(^branches.locate[name;$splitURI.1]){found;not found}:
$branches.name
<HR>
$splitURI[^request:uri.lsplit[/]]
$splitURI.0!$splitURI.1
<HR>

$t2[^table:set{dir	title
/here	Here
}]
$t2{^menu{${dir}-$title}[,]}
<HR>
$dir[news]
$list[^table:dir[$dir]]
^list.menu{
    $subdir[$dir/$list.name]
	$sublist[^table:dir[$subdir]]
	${list.name}/ $sublist{^menu{$name}[,]}<br>
}
<HR>
^if(in "/otherdeeper"){y;n}
<HR>

^^table:dir[/]:<BR>
$d[^table:dir[/]]
$d{^menu{$name &nbsp^;&nbsp^;&nbsp^;&nbsp^;^if(-f $name){-f} ^if(-d $name){-d};<BR>}}
<HR>

$files[^table:set{name}]
$d{^menu{
    ^if(-d "$name"){
        ^:files.append{$name}
    }
}}

$files{^menu{$name}[,]}
<HR>

@exception[origin;source;comment;type;code][i;j]
<body bgcolor=black>
<font color=white>
ERROR:
^if(def $source){$origin '$source'}
${comment}.
^if(def $type){type=$type}
^if(def $code){code=$code}

@auto_test[]
^BASE.auto_test[]
<li>${request:uri}!
@end


@sql_test[connect-string]
#^rem{
#^for[i](1;2){
^connect[$connect-string]{
	$shit[^taint[our's]]
#	$paf[^table:sql{insert into paf (name, age) values ('$shit', ^random:generate(10000))}]
	$paf[^table:sql{select * from paf order by id desc}(5)]
	$paf{
	^if(^empty[]){query result is empty}{
	<table border=1>
		<tr><td>id</td><td>name</td><td>age</td></tr>
		^menu{<tr><td>$id</td><td>$name</td><td>$age</td></tr>}
	</table>
	}}
}
#}
#}

@default[test;def]
$result[^if(^test.length[]){$test}{$def}]
