@auto[]
$html-typo[^table:set{user	html	comment
<<	&laquo^;	длинные user вперёд
>>	&raquo^;
\n\n	<p>	!эти есть в таблице по умолчанию
\n	<br>	!но т.к. заменяем, надо повторить.
<	&lt^;	!можно этим воспользоваться,
>	&gt^;	!и что-то сделать ДО обычных замен
"	&quot^;	!например из << и >>
&	&amp^;	!сделать ёлочки-кавычки.
_	&nbsp^;
^#AB	&laquo^;	windows коды ёлочек
^#BB	&raquo^;	windows коды ёлочек
(c)	&copy^;
^#A9	&copy^;	windows (c)
}]

@dump[t]
^t.menu{$n<BR>}
<HR>
@func[n]
$n
@twop[a;b]
($a,$b)

@Zpost-process[data]
#(<BR>$data)<BR>
^data.match[1][g]{X}

@mt[s;m]
$m ^if(^s.match[$:m;i]){matches}{does not match} $s<BR>

@main[]
^mail:send[
	$content-type[
	    $value[text/plain]
    	$charset[windows-1251]
	]
    $to[paul]
    $from[paf]
    $body[
    	hi, paul.

    	sincerily yours,
    	PAF
    ]
]
<HR>


^mail:send{
	$content-type[
	    $value[text/plain]
    	$charset[windows-1251]
	]
    $to[sdsfsdf]
    $from[sdfsdf]
    $body[
    	$1[ sdfsdf]
    	$2[
			$to[sdsfsdf]
    		$from[sdfsdf]
    		$content-type[sdfsdf]
    		$body[$image]
    	]
    ]
}

<HR>

^^table:dir[/]:<BR>
$d[^table:dir[/]]
^d.menu{$name;<BR>}
<HR>

^^table:dir[/;html^$]<BR>
$d[^table:dir[/;html^$]]
^d.menu{$name;<BR>}
<HR>

^connect[$SQL.connect-string]{
	$shit[^taint[our's]]
#	$paf[^table:sql{insert into paf (name, age) values ('$shit', ^random:generate(10000))}]
	$paf[^table:sql{select * from paf order by id desc}(5)]
	$paf{
	^empty{query result is empty}{
	<table border=1>
		<tr><td>id</td><td>name</td><td>age</td></tr>
		^menu{<tr><td>$id</td><td>$name</td><td>$age</td></tr>}
	</table>
	}}
}

<HR>

$with-cr[^table:set{a	b
^taint[<1
2>]	3
}]
"$with-cr.a"<BR>
<HR>
^if(def $form:s){
	$form:s<BR>
	^form:s.match[!][g]{<b>!</b>}<BR>
	<HR>
}

$r[1223]
^^"$r".match[2][]{(^$match)}=^r.match[2][]{($match)}<BR>
^^"$r".match[2][i]{(^$match)}=^r.match[2][i]{($match)}<BR>
^^"$r".match[2][g]{(^$match)}=^r.match[2][g]{($match)}<BR>
^^"$r".match[2+][g]{(^$match)}=^r.match[2+][g]{($match)}<BR>
<HR>
$s[abcЯ]
$sm[^s.match[(.)][g]]
^^"$s".match[(.)][g]:<BR>
^sm.menu{
	^line[]:<BR>
	^$pre-match=$pre-match<BR>
	^$match=$match<BR>
	^$post-match=$post-match<BR>
	^$1=$1<BR>
}
<HR>
$sm[^s.match[(.)][]]
^^"$s".match[(.)][]:<BR>
^sm.menu{
	^line[]:<BR>
	^$pre-match=$pre-match<BR>
	^$match=$match<BR>
	^$post-match=$post-match<BR>
	^$1=$1<BR>
}
<HR>
^mt[$s;я]
^mt[$s;Я]
^mt[$s;b]
^mt[$s;^^b]
^mt[$s;^^a]
^mt[$s;x]

<HR>

$dest[^table:set[nameless]{
$form:d11	d12	d13
d21	d22	d23
}]
$src[^table:set{a	b	c	d

s1	s2	s3	s4
}]
1:<BR>^dest.menu{$0!$1!$2!$3!<BR>}
^dest.join[$src]
2:<BR>^dest.menu{$0!$1!$2!$3!<BR>}

<HR>
$dest[^table:set{a	b	c
d11	d12	d13
d21	d22	d23
}]
$src[^table:set{a	b	c	d
s1	s2	s3	s4
}]
^dest.join[$src]
^dest.menu{$a!$b!$c!<BR>}

<HR>
^^random:generate(10)=^random:generate(10)<BR>


<HR>
$t[^table:load[/test.cfg]]
$t{
^menu{$a!$b!$c<BR>}
<HR>
^append{x	y	z}
^menu{$a!$b!$c<BR>}
<HR>
^flip[]
^menu{$0!$1!$2!$3<BR>}
<HR>
}

$a[vasya,fedya,kolya]
^^"$a".lsplit[,]=$as[^a.lsplit[,]]$as.0|$as.1|$as.2|$as.3<BR>
^^"$a".rsplit[,]=$as[^a.rsplit[,]]$as.0|$as.1|$as.2|$as.3<BR>
^^a.pos(sy]="^a.pos[sy]"<BR>
^^a.pos[zsy]="^a.pos[zsy]"<BR>
^^a.left(3)="^a.left(3)"<BR>
^^a.right(3)="^a.right(3)"<BR>
^^a.mid(1;3)="^a.mid(1;3)"<BR>
<HR>
^^twop[a;]=^twop[a;]<BR>
^$request:browser.type=$request:browser.type<BR>
^$request:browser.version=$request:browser.version<BR>

$tf[^file:load[test.zip;abc.zip;image/gif]]
#$response:body[$tf]

^$tf.name=$tf.name<BR>
^$tf.size=$tf.size<BR>
^$tf.mime-type=$tf.mime-type<BR>
^$tf.text:<BR>
$tf.text<HR>
<HR>
^file:find[test.cfg]<BR>
^file:find[tes.cfg]{not found}<BR>
<HR>

$t[^table:set{n
3
01.3
1.2
2
}]
$t{^locate[n;2z]^found{$n}{not found}}<BR>
$t{^locate[n;3]^found{found:$n}{not found}}<BR>
^$t:<BR>
^dump[$t]
^t.sort($n)
^^t.sort(^$n):<BR>
^dump[$t]
^t.sort{^:func($n)}
^^t.sort{^^:func(^$n)}:<BR>
^dump[$t]
^t.sort{$n}
^^t.sort{^$n}:<BR>
^dump[$t]
^t.sort{$n}[desc]
^^t.sort{^$n}[desc]:<BR>
^dump[$t]
<HR>

^if(-f index.html){y}{n}<BR>
^taint[html-typo;не знаю
я ничего

<<слово длинное>>

(c) by Я
]<HR>
$t[^table:load[/test.cfg]]
^process[@b[]
f
]
^b[]<BR>

^$t.a=$t.a<BR>
^t.offset[2]
#$r[^t.record[]]
#^$r.a=$r.a<BR>

^$request:uri=$request:uri<BR>
^$env:PATH_INFO=$env:PATH_INFO<BR>
^$env:REMOTE_ADDR=$env:REMOTE_ADDR<BR>

^rem{
$response:body[]
$response:location[http://parser3/123]
}


<HR>
^^auto_test[]:<BR>
<ol>
^auto_test[]
</ol>
<HR>

^${cookie:вот}=${cookie:вот}?<BR>
^${cookie:вот}=${cookie:вот}?<BR>
^$request:query=$request:query<BR>
^$request:uri=$request:uri<BR>

<form method=post>
<table border=1 width=250><tr><td>$form:name</td></tr></table>
<textarea name=name rows=5 cols=40>^untaint[html]{^default[$form:name;Пробный текст: А.Ф._Петросян <<Жизнь в Аду>>
нажми Submit]}</textarea><BR>
<input type=submit>
</form>

<HR>
$свойства_когда_пьян[
	$цвет_глаз[красный]
]
$вася[
	$свойства[$свойства_когда_пьян]
]

$кусок_имени_поля[ства]
^$кусок_имени_поля=$кусок_имени_поля<BR>
^$вася.свой^$кусок_имени_поля.цвет_глаз=$вася.свой$кусок_имени_поля.цвет_глаз
<HR>
<form method=post enctype=multipart/form-data>
<input name=photo type=file>
<input type=submit>
</form>
<hr>
^if($form:photo){
	<pre>
	^$form:photo.name='$form:photo.name'
	^$form:photo.size='$form:photo.size'
	^$form:photo.text='$form:photo.text'
	^form:photo.save[paf.txt]
	</pre>
}

#todo proper! untaint $response:refresh[$value[2] $content[url=http://design.ru]]


@default[test;def]
$result[^if(^test.length[]){$test}{$def}]

@exception[origin;source;comment;type;code]
<body bgcolor=black>
<font color=white>
ERROR:
^if(def $source){$origin '$source'}
${comment}.
^if(def $type){type=$type}
^if(def $code){code=$code}

@auto_test[]
^BASE.auto_test[]
<li>${request:uri}!