@main[]
^xslt[]
OK

@xslt[]
$dom[^dom::set{<?xml version="1.0" encoding="windows-1251"?>

<people>
	<man id="1">
		<name>PAF</name>
	</man>
	<man id="2">
		<name>œ»‘</name>
	</man>
</people>
}]

^show-dnode[$dom]<hr>
$people[^dom.xpath[*/man[@id=1]]]
#^show1[]
^show-dnodes[$people]<hr>
#^people.0.owner.hren[]

@show1[]
^for[i](0;^people._count[]-1){
    $node[$people.$i]
	$node.first-child.value: 
		$pattributes[$node.parent.attributes]
		^if(^pattributes._count[]){
			$pattributes.id.name=$pattributes.id.value
		}
	<br>
}

@show-dnodes[array][i]
^for[i](0;^array._count[]-1){
	^show-dnode[$array.$i]
}

@show-dnode[dnode;level]
$level
^if($dnode.type eq element){
	&lt^;$dnode.name
$pairs[$dnode.attributes]
^if(def $pairs){
	$names[^pairs._keys[]]
	^names.menu{$names.key=$pairs.[$names.key].value }
}
&gt^;
}{[$dnode.type]}
 
^if(def $dnode.value){'$dnode.value'}<br>
^if(def ${dnode.first-child}){^show-dnode[$dnode.first-child]($level+1)}
^if(def ${dnode.next-sibling}){^show-dnode[$dnode.next-sibling]($level)}

^if($dnode.type eq element){
$level&lt^;/$dnode.name&gt^;<br>
}
